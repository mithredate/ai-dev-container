#!/bin/sh
# shellcheck shell=dash
# Gofmt wrapper - routes to sidecar container via bridge when BRIDGE_ENABLED=1

if [ "$BRIDGE_ENABLED" = "1" ]; then
    exec bridge gofmt "$@"
else
    # Find the real gofmt binary (skip this wrapper)
    SELF=$(command -v gofmt)
    for BIN in /usr/local/go/bin/gofmt /usr/bin/gofmt; do
        if [ -x "$BIN" ] && [ "$BIN" != "$SELF" ]; then
            exec "$BIN" "$@"
        fi
    done
    echo "Error: gofmt not found (BRIDGE_ENABLED not set and no local gofmt installation)" >&2
    exit 127
fi
