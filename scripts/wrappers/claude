#!/bin/sh
# Wrapper for claude that handles CLAUDE_YOLO and ensures non-root execution
CLAUDE_BIN="/usr/local/bin/claude"
CONTAINER_USER="claude"

# Add --dangerously-skip-permissions if CLAUDE_YOLO is set
if [ "$CLAUDE_YOLO" = "1" ]; then
    set -- --dangerously-skip-permissions "$@"
fi

# Drop to claude user if running as root
if [ "$(id -u)" -eq 0 ]; then
    exec su -s /bin/sh "$CONTAINER_USER" -c "\"$CLAUDE_BIN\" $*"
else
    exec "$CLAUDE_BIN" "$@"
fi
